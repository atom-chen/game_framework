{
  "code": "import * as tslib_1 from \"tslib\";\r\nimport ConfigManager from \"../../games/ConfigManager\";\r\nimport { PlayerDataManager } from \"../../common/GameDataManager\";\r\nimport { GoodsType } from \"../../games/CommonDefine\";\r\nimport FailEntryTwoView from \"./FailEntryTwoView\";\r\nimport ViewChangeManager from \"../../games/ViewChangeManager\";\r\nimport AnimationManager from \"../../manager/AnimationManager\";\r\nimport SoundManager from \"../../common/SoundManager\";\r\nimport { MiniManeger } from \"../../minigame/MiniManeger\";\r\nimport MoreGameRandomGameBox713 from \"./wecat/MoreGameRandomGameBox713\";\r\nimport MoreGameView from \"./wecat/MoreGameView\";\r\nvar FailEntryOneView = (function (_super) {\r\n    tslib_1.__extends(FailEntryOneView, _super);\r\n    function FailEntryOneView() {\r\n        var _this = _super.call(this) || this;\r\n        _this.className_key = \"FailEntryOneView\";\r\n        _this.showEnterType = BasePopAnimationEnterType.SCALE_MODE_BACK;\r\n        _this.nBtNextLevel = 360;\r\n        _this.nBtNextLevelSp = 50;\r\n        _this.nGlodCost = 200;\r\n        _this.skin = \"game/uiView/FailEntryOneView.json\";\r\n        return _this;\r\n    }\r\n    FailEntryOneView.prototype.childrenCreated = function () {\r\n        _super.prototype.childrenCreated.call(this);\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n        }\r\n    };\r\n    FailEntryOneView.prototype.onAddStage = function () {\r\n        MiniManeger.instance.showInterstitialAd();\r\n        this.initView();\r\n        this.addEvent();\r\n        MiniManeger.instance.showBannerAd();\r\n    };\r\n    FailEntryOneView.prototype.onRemoved = function () {\r\n        _super.prototype.onRemoved.call(this);\r\n        this.removeEvent();\r\n        if (this.aniReal) {\r\n            this.aniReal.stop();\r\n        }\r\n        Laya.Tween.clearAll(this.image_wm);\r\n    };\r\n    FailEntryOneView.prototype.initView = function () {\r\n        this.forExamine();\r\n        this.refreshLable();\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            if (!this.aniReal) {\r\n                this.createSkeleton(\"resource/assets/img/ani/failure/failure.sk\");\r\n            }\r\n            else {\r\n                this.aniReal.play(0, true);\r\n            }\r\n        }\r\n        this.refreshReLiveByGlod();\r\n        this.initPl();\r\n    };\r\n    FailEntryOneView.prototype.addEvent = function () {\r\n        this.imageRecv.on(Laya.Event.CLICK, this, this.onCostGlodRelive);\r\n        this.imageBtSign.on(Laya.Event.CLICK, this, this.onWatchVideoToRelive);\r\n        this.btLable.on(Laya.Event.CLICK, this, this.onNoThanks);\r\n        this.img_back.on(Laya.Event.CLICK, this, this.onBack);\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            this.image_wm.on(Laya.Event.CLICK, MiniManeger.instance, MiniManeger.instance.toGameSpecial);\r\n        }\r\n    };\r\n    FailEntryOneView.prototype.removeEvent = function () {\r\n        this.imageRecv.off(Laya.Event.CLICK, this, this.onCostGlodRelive);\r\n        this.imageBtSign.off(Laya.Event.CLICK, this, this.onWatchVideoToRelive);\r\n        this.btLable.off(Laya.Event.CLICK, this, this.onNoThanks);\r\n        this.img_back.off(Laya.Event.CLICK, this, this.onBack);\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            this.image_wm.off(Laya.Event.CLICK, MiniManeger.instance, MiniManeger.instance.toGameSpecial);\r\n        }\r\n    };\r\n    FailEntryOneView.prototype.onWatchVideoToRelive = function () {\r\n        SoundManager.getInstance().playEffect(\"button\", 1);\r\n        this.imageBtSign.off(Laya.Event.CLICK, this, this.onWatchVideoToRelive);\r\n        var self = this;\r\n        if (ViewChangeManager.getInstance().CurLevelBase) {\r\n            ViewChangeManager.getInstance().CurLevelBase.levelOnHide();\r\n        }\r\n        MiniManeger.instance.playViderAd({\r\n            successFun: function () {\r\n                Laya.timer.once(100, self, function () {\r\n                    self.onFailRestartGame();\r\n                    if (ViewChangeManager.getInstance().CurLevelBase) {\r\n                        ViewChangeManager.getInstance().CurLevelBase.levelOnShow();\r\n                    }\r\n                });\r\n                console.log(\"onFailRestartGame xxx\");\r\n                self.imageBtSign.on(Laya.Event.CLICK, self, self.onWatchVideoToRelive);\r\n            },\r\n            failFun: function () {\r\n                self.imageBtSign.on(Laya.Event.CLICK, self, self.onWatchVideoToRelive);\r\n                if (ViewChangeManager.getInstance().CurLevelBase) {\r\n                    ViewChangeManager.getInstance().CurLevelBase.levelOnShow();\r\n                }\r\n            },\r\n            errorFun: function () {\r\n                self.imageBtSign.on(Laya.Event.CLICK, self, self.onWatchVideoToRelive);\r\n                if (ViewChangeManager.getInstance().CurLevelBase) {\r\n                    ViewChangeManager.getInstance().CurLevelBase.levelOnShow();\r\n                }\r\n            }\r\n        });\r\n    };\r\n    FailEntryOneView.prototype.onFailRestartGame = function () {\r\n        if (DeviceUtil.isTTMiniGame() || DeviceUtil.isWXMiniGame()) {\r\n            MiniManeger.instance.hideBanner();\r\n        }\r\n        ViewChangeManager.getInstance().restartGame(false);\r\n        MiniManeger.instance.bFlagSpecialView = true;\r\n        this.removeSelf();\r\n    };\r\n    FailEntryOneView.prototype.onCostGlodRelive = function () {\r\n        SoundManager.getInstance().playEffect(\"button\", 1);\r\n        var b = PlayerDataManager.getInstance().CheckGoods(GoodsType.enum_GoodsType_Glod, this.nGlodCost);\r\n        if (!b) {\r\n            return;\r\n        }\r\n        PlayerDataManager.getInstance().subGoods(GoodsType.enum_GoodsType_Glod, this.nGlodCost);\r\n        this.onFailRestartGame();\r\n    };\r\n    FailEntryOneView.prototype.onBack = function () {\r\n        MoreGameRandomGameBox713.bOperFlag = false;\r\n        ViewManager.getInstance().showView(MoreGameRandomGameBox713);\r\n        MiniManeger.instance.bFlagSpecialView = true;\r\n        this.removeSelf();\r\n    };\r\n    FailEntryOneView.prototype.onNoThanks = function () {\r\n        SoundManager.getInstance().playEffect(\"button\", 1);\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            if (PlayerDataManager.getInstance().checkIsSpecial() && BaseConst.infos.gameInfo.MoreGameView == 1) {\r\n                MoreGameView.bSuccess = false;\r\n                ViewManager.getInstance().showView(MoreGameView);\r\n            }\r\n            else {\r\n                MoreGameRandomGameBox713.bOperFlag = true;\r\n                MoreGameRandomGameBox713.bSuccess = false;\r\n                ViewManager.getInstance().showView(MoreGameRandomGameBox713);\r\n            }\r\n        }\r\n        else {\r\n            ViewManager.getInstance().showView(FailEntryTwoView);\r\n        }\r\n        MiniManeger.instance.bFlagSpecialView = true;\r\n        this.removeSelf();\r\n    };\r\n    FailEntryOneView.prototype.refreshReLiveByGlod = function () {\r\n        var stGameConfig = ConfigManager.getInstance().getGameConfigDataByID(6);\r\n        if (stGameConfig) {\r\n            this.nGlodCost = parseInt(stGameConfig.strValue);\r\n        }\r\n        var b = PlayerDataManager.getInstance().CheckGoods(GoodsType.enum_GoodsType_Glod, this.nGlodCost);\r\n        if (!b) {\r\n            this.imageRecv.visible = false;\r\n            return;\r\n        }\r\n        this.imageRecv.visible = true;\r\n        BitmapLabelUtils.setLabel(this.spGlod, this.nGlodCost.toString(), \"resource/assets/img/common/level_number1/level_number1_\", 0, \".png\", \"left\");\r\n    };\r\n    FailEntryOneView.prototype.createSkeleton = function (url) {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            AnimationManager.instance.showSkeletonAnimation(url, function (boomAnimation) {\r\n                _this.aniReal = boomAnimation;\r\n                _this.aniReal.player.playbackRate = 1;\r\n                _this.aniReal.autoSize = true;\r\n                _this.aniReal.scale(1, 1);\r\n                _this.aniReal.play(0, true);\r\n                _this.aniReal.x = _this.aniReal.width - 100;\r\n                _this.aniReal.y = _this.aniReal.height;\r\n                _this.boxAni.addChild(_this.aniReal);\r\n                resolve(boomAnimation);\r\n            }, 1);\r\n        });\r\n    };\r\n    FailEntryOneView.prototype.refreshLable = function () {\r\n        var _this = this;\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            return;\r\n        }\r\n        this.btLable.visible = false;\r\n        Laya.timer.once(3000, this, function () {\r\n            _this.btLable.visible = true;\r\n        });\r\n    };\r\n    FailEntryOneView.prototype.forExamine = function () {\r\n    };\r\n    FailEntryOneView.prototype.startWmAni = function () {\r\n        var _this = this;\r\n        Laya.Tween.clearAll(this.image_wm);\r\n        Laya.Tween.to(this.image_wm, { scaleX: 1.1, scaleY: 1.1 }, 300, Laya.Ease.sineOut, Laya.Handler.create(this, function (args) {\r\n            Laya.Tween.to(_this.image_wm, { scaleX: 1, scaleY: 1 }, 300, Laya.Ease.sineOut, Laya.Handler.create(_this, function (args) {\r\n                Laya.timer.once(0, _this, _this.startWmAni);\r\n            }));\r\n        }));\r\n    };\r\n    FailEntryOneView.prototype.initPl = function () {\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            this.box_wecat.removeChildren();\r\n            this.box_wecat.addChild(ViewChangeManager.getInstance().showMoreGameinView(true));\r\n            var stGameConfig = ConfigManager.getInstance().getGameConfigDataByID(6);\r\n            if (stGameConfig) {\r\n                this.nGlodCost = parseInt(stGameConfig.strValue);\r\n            }\r\n            var b = PlayerDataManager.getInstance().CheckGoods(GoodsType.enum_GoodsType_Glod, this.nGlodCost);\r\n            if (b) {\r\n                this.boxAni.visible = false;\r\n                this.box_wecat.visible = true;\r\n                this.imageRecv.bottom = this.imageBtSign.bottom;\r\n                this.imageRecv.centerX = 250;\r\n                this.imageBtSign.centerX = -250;\r\n            }\r\n            else {\r\n                this.imageBtSign.centerX = 0;\r\n            }\r\n            this.boxAni.visible = false;\r\n            if (BaseConst.infos.gameInfo.openPsAward == 1 && BaseConst.infos.gameInfo.for_pay == 1) {\r\n                this.btLable.bottom = this.nBtNextLevelSp;\r\n                MiniManeger.instance.bFlagSpecialView = false;\r\n                MiniManeger.instance.hideBanner();\r\n                return;\r\n            }\r\n            else {\r\n                this.btLable.bottom = this.nBtNextLevel;\r\n            }\r\n        }\r\n        else {\r\n            MiniManeger.instance.bFlagSpecialView = true;\r\n            MiniManeger.instance.showBannerAd();\r\n        }\r\n    };\r\n    return FailEntryOneView;\r\n}(BaseSceneUISkinPopView));\r\nexport default FailEntryOneView;\r\n",
  "references": [
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/ConfigManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/GameDataManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/CommonDefine.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/FailEntryTwoView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/ViewChangeManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/manager/AnimationManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/SoundManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/minigame/MiniManeger.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/MoreGameOperRequestTwo.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/MoreGameRandomGameBox713.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/MoreGameView.ts"
  ]
}
