{
  "code": "import * as tslib_1 from \"tslib\";\r\nimport ConfigManager from \"../../games/ConfigManager\";\r\nimport { PlayerDataManager } from \"../../common/GameDataManager\";\r\nimport { GoodsType } from \"../../games/CommonDefine\";\r\nimport SuccessfulEntryThreeView from \"./SuccessfulEntryThreeView\";\r\nimport SoundManager from \"../../common/SoundManager\";\r\nimport GameLogicProcessingManager from \"../../games/GameLogicProcessingManager\";\r\nimport { MiniManeger } from \"../../minigame/MiniManeger\";\r\nimport ViewChangeManager from \"../../games/ViewChangeManager\";\r\nimport MoreGameOperRequestTwo from \"./wecat/MoreGameOperRequestTwo\";\r\nvar SuccessfulEntryOneView = (function (_super) {\r\n    tslib_1.__extends(SuccessfulEntryOneView, _super);\r\n    function SuccessfulEntryOneView() {\r\n        var _this = _super.call(this) || this;\r\n        _this.className_key = \"SuccessfulEntryOneView\";\r\n        _this.showEnterType = BasePopAnimationEnterType.SCALE_MODE_BACK;\r\n        _this.bBinnerShow = false;\r\n        _this.nTimeDown = 5;\r\n        _this.nCountMax = 5;\r\n        _this.nPsAdd = 1;\r\n        _this.nAddPerOne = 0;\r\n        _this.nCurCount = 0;\r\n        _this.bTimeOver = false;\r\n        _this.bAniRunning = false;\r\n        _this.bFirst = true;\r\n        _this.nTimeOverTemp = 0;\r\n        _this.nLastClickTime = 0;\r\n        _this.bBinnerShow = false;\r\n        _this.skin = \"game/uiView/SuccessfulEntryOneView.json\";\r\n        return _this;\r\n    }\r\n    SuccessfulEntryOneView.prototype.childrenCreated = function () {\r\n        _super.prototype.childrenCreated.call(this);\r\n    };\r\n    SuccessfulEntryOneView.prototype.onAddStage = function () {\r\n        MiniManeger.instance.showInterstitialAd();\r\n        this.initView();\r\n        this.addEvent();\r\n        this.imageBt.bottom = 0;\r\n        this.moveBtnTween = null;\r\n        MiniManeger.instance.bFlagSpecialView = false;\r\n        this.bBinnerShow = false;\r\n        MiniManeger.instance.hideBanner();\r\n        ViewChangeManager.getInstance().CommonView.visible = false;\r\n    };\r\n    SuccessfulEntryOneView.prototype.onRemoved = function () {\r\n        _super.prototype.onRemoved.call(this);\r\n        this.removeEvent();\r\n        this.bFirst = false;\r\n        this.bAniRunning = false;\r\n        Laya.Tween.clearAll(this.imageHand);\r\n        Laya.timer.clearAll(this);\r\n        MiniManeger.instance.bFlagSpecialView = true;\r\n    };\r\n    SuccessfulEntryOneView.prototype.initView = function () {\r\n        SoundManager.getInstance().playEffect(\"win\", 1);\r\n        this.nTimeDown = 5;\r\n        this.nCountMax = 5;\r\n        this.nPsAdd = 1;\r\n        this.nAddPerOne = 0;\r\n        this.nCurCount = 0;\r\n        this.bTimeOver = false;\r\n        this.bAniRunning = true;\r\n        this.bFirst = true;\r\n        var stGameConfig = ConfigManager.getInstance().getGameConfigDataByID(9);\r\n        if (stGameConfig) {\r\n            this.nTimeDown = parseInt(stGameConfig.strValue);\r\n        }\r\n        BitmapLabelUtils.setLabel(this.spTimeDown, this.nTimeDown.toString(), \"resource/assets/img/ui/success/succeed_number2/succeed_number2_\", 0, \".png\", \"center\");\r\n        stGameConfig = ConfigManager.getInstance().getGameConfigDataByID(10);\r\n        if (stGameConfig) {\r\n            this.nCountMax = parseInt(stGameConfig.strValue);\r\n        }\r\n        stGameConfig = ConfigManager.getInstance().getGameConfigDataByID(11);\r\n        if (stGameConfig) {\r\n            this.nPsAdd = parseInt(stGameConfig.strValue);\r\n        }\r\n        stGameConfig = ConfigManager.getInstance().getGameConfigDataByID(14);\r\n        if (stGameConfig) {\r\n            this.nTimeOverTemp = parseInt(stGameConfig.strValue);\r\n        }\r\n        this.nAddPerOne = Math.floor(870 / this.nCountMax);\r\n        this.imageParValue.width = 0;\r\n        this.openTimeDown();\r\n        this.openHandAni();\r\n    };\r\n    SuccessfulEntryOneView.prototype.addEvent = function () {\r\n        this.imageBt.on(Laya.Event.CLICK, this, this.imageBtClickRecvAward);\r\n    };\r\n    SuccessfulEntryOneView.prototype.removeEvent = function () {\r\n        this.imageBt.off(Laya.Event.CLICK, this, this.imageBtClickRecvAward);\r\n    };\r\n    SuccessfulEntryOneView.prototype.imageBtClickRecvAward = function () {\r\n        SoundManager.getInstance().playEffect(\"button\", 1);\r\n        if (this.bTimeOver) {\r\n            return;\r\n        }\r\n        this.nCurCount += 1;\r\n        var nWithCur = this.nCurCount * this.nAddPerOne;\r\n        this.imageParValue.width = nWithCur;\r\n        if (this.nCurCount >= this.nCountMax) {\r\n            Laya.timer.clear(this, this.timeDownView);\r\n            this.procLogicOver();\r\n        }\r\n        this.nLastClickTime = GameLogicProcessingManager.GetCurTime();\r\n    };\r\n    SuccessfulEntryOneView.prototype.openTimeDown = function () {\r\n        BitmapLabelUtils.setLabel(this.spTimeDown, this.nTimeDown.toString(), \"resource/assets/img/ui/success/succeed_number2/succeed_number2_\", 0, \".png\", \"center\");\r\n        Laya.timer.loop(1000, this, this.timeDownView);\r\n        Laya.timer.loop(this.nTimeOverTemp, this, this.subCount);\r\n    };\r\n    SuccessfulEntryOneView.prototype.subCount = function () {\r\n        this.nCurCount -= 1;\r\n        this.nCurCount = this.nCurCount < 0 ? 0 : this.nCurCount;\r\n        var nWithCur = this.nCurCount * this.nAddPerOne;\r\n        this.imageParValue.width = nWithCur;\r\n    };\r\n    SuccessfulEntryOneView.prototype.timeDownView = function () {\r\n        this.nTimeDown -= 1;\r\n        var nTemp = this.nTimeDown;\r\n        nTemp = nTemp < 0 ? 0 : nTemp;\r\n        BitmapLabelUtils.setLabel(this.spTimeDown, nTemp.toString(), \"resource/assets/img/ui/success/succeed_number2/succeed_number2_\", 0, \".png\", \"center\");\r\n        if (this.nTimeDown < 0) {\r\n            this.bTimeOver = true;\r\n            this.procLogicOver();\r\n        }\r\n    };\r\n    SuccessfulEntryOneView.prototype.procLogicOver = function () {\r\n        Laya.timer.clear(this, this.timeDownView);\r\n        if (this.bTimeOver) {\r\n            TipsManager.getInstance().showDefaultTips(\"领取失败\");\r\n        }\r\n        else if (this.nCurCount >= this.nCountMax) {\r\n            PlayerDataManager.getInstance().AddGoods(GoodsType.enum_GoodsType_Sp, this.nPsAdd);\r\n            TipsManager.getInstance().showDefaultTips(\"体力+\" + this.nPsAdd.toString());\r\n        }\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            if (PlayerDataManager.bGlobEnterGame) {\r\n                ViewManager.getInstance().showView(MoreGameOperRequestTwo);\r\n                MiniManeger.instance.bFlagSpecialView = true;\r\n                this.removeSelf();\r\n            }\r\n            else {\r\n                ViewChangeManager.getInstance().goToNextLevel();\r\n                this.removeSelf();\r\n            }\r\n        }\r\n        else {\r\n            ViewManager.getInstance().showView(SuccessfulEntryThreeView);\r\n            ViewChangeManager.getInstance().CommonView.visible = true;\r\n            this.removeSelf();\r\n            MiniManeger.instance.bFlagSpecialView = true;\r\n        }\r\n    };\r\n    SuccessfulEntryOneView.prototype.openHandAni = function () {\r\n        var _this = this;\r\n        if (!this.bAniRunning) {\r\n            return;\r\n        }\r\n        var yTemp = this.imageHand.y;\r\n        Laya.Tween.clearAll(this.imageHand);\r\n        Laya.Tween.to(this.imageHand, { y: yTemp - 25 }, 300, null, Laya.Handler.create(this, function (args) {\r\n            Laya.Tween.to(_this.imageHand, { y: yTemp }, 300, null, Laya.Handler.create(_this, function (args) {\r\n                Laya.timer.once(0, _this, _this.openHandAni);\r\n            }));\r\n        }));\r\n    };\r\n    return SuccessfulEntryOneView;\r\n}(BaseSceneUISkinPopView));\r\nexport default SuccessfulEntryOneView;\r\n",
  "references": [
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/ConfigManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/GameDataManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/CommonDefine.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/SuccessfulEntryThreeView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/SoundManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/GameLogicProcessingManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/minigame/MiniManeger.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/ViewChangeManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/MoreGameOperRequestTwo.ts"
  ]
}
