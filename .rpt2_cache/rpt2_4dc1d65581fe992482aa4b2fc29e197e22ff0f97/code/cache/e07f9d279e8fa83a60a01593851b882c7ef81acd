{
  "code": "import * as tslib_1 from \"tslib\";\r\nimport { GameData } from \"../common/GameData\";\r\nimport InviteManager from \"../manager/InviteManager\";\r\nimport SoundManager from \"../common/SoundManager\";\r\nimport { PlayerDataManager } from \"../common/GameDataManager\";\r\nimport ViewChangeManager from \"../games/ViewChangeManager\";\r\nimport GameEvent from \"../games/GameEvent\";\r\nimport PlatformDY from \"../../PlatformDY\";\r\nimport NativeMgr from \"../tool/NativeMgr\";\r\nimport { HttpMgr } from \"../base/net/HttpMgr\";\r\nimport PlatfprmAiQiYi from \"../../PlatfprmAiQiYi\";\r\nimport GuessLike from \"../views/game/wecat/GuessLike\";\r\nvar MiniManeger = (function () {\r\n    function MiniManeger() {\r\n        this.hideTime = 0;\r\n        this.showTime = 0;\r\n        this.defaultMssage = {\r\n            \"title\": \"休闲解密游戏，开动你的小脑筋帮助公主逃离魔爪！\",\r\n            \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl_ks/Share/500x400-1.jpg?v=\" + 1.0,\r\n            \"query\": \"\"\r\n        };\r\n        this.shareInfo = [\r\n            {\r\n                \"title\": \"烧脑推理，一键过关！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl_ks/Share/500x400-1.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            },\r\n            {\r\n                \"title\": \"休闲解密游戏，开动你的小脑筋帮助公主逃离魔爪！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl_ks/Share/500x400-2.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            },\r\n            {\r\n                \"title\": \"机会只有一次！救救公主！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl_ks/Share/500x400-3.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            },\r\n            {\r\n                \"title\": \"休闲解密游戏，开动你的小脑筋帮助公主逃离魔爪！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl_ks/Share/500x400-4.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            },\r\n            {\r\n                \"title\": \"机会只有一次！救救公主！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl_ks/Share/500x400-5.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            }\r\n        ];\r\n        this.shareInfoTT = [\r\n            {\r\n                \"title\": \"烧脑推理，一键过关！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl_ks/Share/500x400-1.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            },\r\n            {\r\n                \"title\": \"休闲解密游戏，开动你的小脑筋帮助女孩逃离魔爪！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl_ks/Share/500x400-2.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            },\r\n            {\r\n                \"title\": \"机会只有一次！救救女孩！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl_ks/Share/500x400-3.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            },\r\n            {\r\n                \"title\": \"休闲解密游戏，开动你的小脑筋帮助女孩逃离魔爪！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl_ks/Share/500x400-4.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            },\r\n            {\r\n                \"title\": \"机会只有一次！救救女孩！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl_ks/Share/500x400-5.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            }\r\n        ];\r\n        this.shareInfoDouYin = [\r\n            {\r\n                \"channel\": \"video\",\r\n                \"title\": \"烧脑推理，一键过关！\",\r\n                \"desc\": \"烧脑推理，一键过关\",\r\n                \"imageUrl\": \"\",\r\n                \"query\": \"\",\r\n                \"extra\": {\r\n                    \"videoPath\": \"\",\r\n                    \"videoTopics\": [\"救救女孩\", \"帮助女孩逃出生天\"]\r\n                }\r\n            },\r\n            {\r\n                \"channel\": \"video\",\r\n                \"title\": \"休闲解密游戏，开动你的小脑筋帮助女孩逃离魔爪？\",\r\n                \"desc\": \"休闲解密游戏，开动你的小脑筋帮助女孩逃离魔爪？\",\r\n                \"imageUrl\": \"\",\r\n                \"query\": \"\",\r\n                \"extra\": {\r\n                    \"videoPath\": \"\",\r\n                    \"videoTopics\": [\"救救女孩\", \"帮助女孩逃出生天\"]\r\n                }\r\n            },\r\n            {\r\n                \"channel\": \"video\",\r\n                \"title\": \"机会只有一次！救救女孩！\",\r\n                \"desc\": \"机会只有一次！救救女孩！\",\r\n                \"imageUrl\": \"\",\r\n                \"query\": \"\",\r\n                \"extra\": {\r\n                    \"videoPath\": \"\",\r\n                    \"videoTopics\": [\"救救女孩\", \"帮助女孩逃出生天\"]\r\n                }\r\n            }\r\n        ];\r\n        this.bFlagDouYin = false;\r\n        this.sucTime = 0;\r\n        this.canShowBanner = true;\r\n        this.bFlagSpecialView = true;\r\n        this.bTimerOpen = false;\r\n        this.stPhoneInfo = null;\r\n        this.nRecordTime = 60;\r\n        this.nRecordTimeReal = 0;\r\n        this.onShareVideoSuccess = false;\r\n        this.pBlockAd = null;\r\n        this.specialData = [\r\n            {\r\n                \"AppID\": \"wx3aaf3ba7dc737bec\",\r\n                \"path\": \"pages/read/read?chapterId=1653070&comicId=107477\",\r\n                \"extraData\": {\r\n                    \"appName\": \"KingsDaughter\"\r\n                }\r\n            },\r\n            {\r\n                \"AppID\": \"1109631505\",\r\n                \"path\": \"pages/read/read?chapterId=1653070&comicId=107477\",\r\n                \"extraData\": {\r\n                    \"appName\": \"KingsDaughter\"\r\n                }\r\n            },\r\n            {\r\n                \"AppID\": \"ttc63ab0875910457b\",\r\n                \"path\": \"pages/read/read?chapterId=1653070&comicId=107477\",\r\n                \"extraData\": {\r\n                    \"appName\": \"KingsDaughter\"\r\n                }\r\n            }\r\n        ];\r\n        this.strApiUrl = \"https://pv.sohu.com/cityjson?ie=utf-8\";\r\n        this.initVideoInfo();\r\n    }\r\n    Object.defineProperty(MiniManeger, \"instance\", {\r\n        get: function () {\r\n            if (this.ins == null) {\r\n                this.ins = new MiniManeger();\r\n            }\r\n            return this.ins;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MiniManeger.prototype.initMiniGame = function () {\r\n        var _this = this;\r\n        var launchObj = platform.getLaunchOptionsSync();\r\n        if (launchObj) {\r\n            console.log('launchObj>>>>>>>>>>>>>>', launchObj);\r\n        }\r\n        this.getUpdateManager();\r\n        platform.setKeepScreenOn();\r\n        platform.updateShareMenu();\r\n        platform.showShareMenu();\r\n        platform.onShareAppMessage(function () {\r\n            return _this.defaultMssage;\r\n        });\r\n        this.systemInfo = platform.getSystemInfoSync();\r\n        console.log(\"systemInfo >> \", this.systemInfo);\r\n    };\r\n    MiniManeger.prototype.getUpdateManager = function () {\r\n    };\r\n    MiniManeger.prototype.onAudioInterruptionBegin = function (call) {\r\n    };\r\n    MiniManeger.prototype.onAudioInterruptionEnd = function (call) {\r\n    };\r\n    MiniManeger.prototype.getUserInfo = function () {\r\n        return new Promise(function (resolve) {\r\n            resolve(null);\r\n        });\r\n    };\r\n    MiniManeger.prototype.initUserTemp = function () {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var info, strOpenIdOther, strOpenIdOther;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, this.getUserInfo()];\r\n                    case 1:\r\n                        info = _a.sent();\r\n                        if (!(info == null)) return [3, 3];\r\n                        return [4, this.userButtonSize(0, 1, 0)];\r\n                    case 2:\r\n                        info = _a.sent();\r\n                        strOpenIdOther = GameData.getInstance().enterGameInfo.query[\"openid\"];\r\n                        console.log(\"strOpenIdOther = \", strOpenIdOther);\r\n                        if (strOpenIdOther && strOpenIdOther != \"\") {\r\n                            platform.createUserInfoButton(function (data) {\r\n                                GameData.getInstance().userInfo.nick = data.userInfo.nickName;\r\n                                GameData.getInstance().userInfo.avatarUrl = data.userInfo.avatarUrl;\r\n                                if (!BaseConst.infos.gameInfo.isDY) {\r\n                                    InviteManager.getInstance().judgeInvite();\r\n                                    console.log(\"createUserInfoButton 用户信息 : \", GameData.getInstance().userInfo);\r\n                                }\r\n                                info = data;\r\n                            });\r\n                        }\r\n                        return [3, 4];\r\n                    case 3:\r\n                        GameData.getInstance().userInfo.nick = info.userInfo.nickName;\r\n                        GameData.getInstance().userInfo.avatarUrl = info.userInfo.avatarUrl;\r\n                        strOpenIdOther = GameData.getInstance().enterGameInfo.query[\"openid\"];\r\n                        console.log(\"strOpenIdOther = \", strOpenIdOther);\r\n                        if (strOpenIdOther && strOpenIdOther != \"\") {\r\n                            InviteManager.getInstance().judgeInvite();\r\n                            console.log(\"createUserInfoButton 用户信息 judgeInvite: \", GameData.getInstance().userInfo);\r\n                        }\r\n                        _a.label = 4;\r\n                    case 4:\r\n                        MiniManeger.instance.defaultMssage.query = \"openid=\" + GameData.getInstance().userInfo.openId;\r\n                        platform.onShareAppMessage(function () {\r\n                            return MiniManeger.instance.defaultMssage;\r\n                        });\r\n                        return [2, info];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    MiniManeger.prototype.userButtonSize = function (percentTop, pectendSize, percentLeft) {\r\n        var resInfo = platform.getSystemInfoSync();\r\n        var left = resInfo['windowWidth'] * percentLeft;\r\n        var top = resInfo['windowHeight'] * percentTop;\r\n        var wid = resInfo['windowWidth'] * pectendSize;\r\n        var height = resInfo['windowHeight'] * pectendSize;\r\n    };\r\n    MiniManeger.prototype.onShow = function (callBack) {\r\n        var _this = this;\r\n        platform.onShow(function () {\r\n            callBack && callBack();\r\n            _this.showTime = new Date().getTime();\r\n            if (!DeviceUtil.isTTMiniGame()) {\r\n                if (_this.showTime - _this.hideTime >= _this.sucTime) {\r\n                    _this.shareSucful && _this.shareSucful.call(_this.thisObj);\r\n                }\r\n                else {\r\n                    _this.shareFailful && _this.shareFailful.call(_this.thisObj);\r\n                }\r\n            }\r\n            PlayerDataManager.nTimeHidSec = _this.showTime - _this.hideTime;\r\n            if (PlayerDataManager.nTimeHidSec == _this.showTime)\r\n                PlayerDataManager.nTimeHidSec = 0;\r\n            _this.shareFailful = null;\r\n            _this.shareSucful = null;\r\n            _this.thisObj = null;\r\n        });\r\n    };\r\n    MiniManeger.prototype.onHide = function (callBack) {\r\n        var _this = this;\r\n        platform.onHide(function () {\r\n            callBack && callBack();\r\n            _this.hideTime = new Date().getTime();\r\n        });\r\n    };\r\n    MiniManeger.prototype.showMoreGame = function (data) {\r\n        return new Promise(function (resolve) {\r\n        });\r\n    };\r\n    MiniManeger.prototype.getShareInfo = function (query) {\r\n        var shareInfo = this.shareInfo;\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            shareInfo = this.shareInfoTT;\r\n        }\r\n        var info = shareInfo[Math.floor(Math.random() * shareInfo.length)];\r\n        if (query) {\r\n            var openId = GameData.getInstance().userInfo.openId;\r\n            query['openid'] = openId;\r\n        }\r\n        info.query = Utils.querStr(query);\r\n        return info;\r\n    };\r\n    MiniManeger.prototype.testShareVideo = function () {\r\n        var obj = {\r\n            channel: \"video\",\r\n            title: \"测试分享视频\",\r\n            desc: \"测试描述\",\r\n            imageUrl: \"\",\r\n            templateId: \"\",\r\n            query: \"\",\r\n            extra: {\r\n                videoPath: \"ttfile://temp/test.mp4\",\r\n                videoTopics: [\"话题11\", \"话题21\"]\r\n            },\r\n            success: function () {\r\n                console.log(\"分享视频成功\");\r\n            },\r\n            fail: function (e) {\r\n                console.log(\"分享视频失败\");\r\n            }\r\n        };\r\n        obj.extra.videoPath = this.strVideoPatch;\r\n        platform.shareAppMessage(obj);\r\n    };\r\n    MiniManeger.prototype.getShareInfoDouYin = function (query) {\r\n        var shareInfo = this.shareInfoDouYin;\r\n        var info = shareInfo[Math.floor(Math.random() * shareInfo.length)];\r\n        if (query) {\r\n            var openId = GameData.getInstance().userInfo.openId;\r\n            query['openid'] = openId;\r\n        }\r\n        info.query = Utils.querStr(query);\r\n        info.extra.videoPath = this.strVideoPatch;\r\n        return info;\r\n    };\r\n    MiniManeger.prototype.shareAppMessage = function (data) {\r\n        if (data == null) {\r\n            data = {};\r\n        }\r\n        if (!data.message) {\r\n            data.message = this.getShareInfo({});\r\n        }\r\n        if (this.isAiQiYi()) {\r\n            PlatfprmAiQiYi.shareAiQiYi(data.message.title, data.message.title, data.message.imageUrl);\r\n            return;\r\n        }\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            var info = platform.getSystemInfoSync();\r\n            if (info.appName.toUpperCase() == 'DOUYIN' && this.bFlagDouYin) {\r\n                data.message = this.getShareInfoDouYin({});\r\n                console.log(\"data.message = \", data.message);\r\n            }\r\n            if (data.sucFun) {\r\n                data.sucFun && (data.message.success = data.sucFun);\r\n            }\r\n            else {\r\n                data.message.success = function () {\r\n                    TipsManager.getInstance().showDefaultTips('分享成功!');\r\n                };\r\n            }\r\n            if (data.failFun) {\r\n                data.failFun && (data.message.fail = data.failFun);\r\n            }\r\n            else {\r\n                data.message.fail = function () {\r\n                };\r\n            }\r\n            platform.shareAppMessage(data.message);\r\n            return;\r\n        }\r\n        this.shareSucful = data.sucFun;\r\n        this.shareFailful = function () {\r\n            data.failFun && data.failFun();\r\n            ;\r\n        };\r\n        this.thisObj = data.thisObj;\r\n        this.sucTime = data.time || 1500;\r\n        if (DeviceUtil.isWXMiniGame() || DeviceUtil.isQQMiniGame()) {\r\n            platform.shareAppMessage(data.message);\r\n        }\r\n    };\r\n    MiniManeger.prototype.playViderAd = function (data) {\r\n        if (DeviceUtil.isNative()) {\r\n            NativeMgr.getInstance().showVideoAd(function () {\r\n                data.successFun && data.successFun();\r\n            }, function () {\r\n                data.errorFun && data.errorFun();\r\n            });\r\n            return;\r\n        }\r\n        if (!DeviceUtil.isMiniGame()) {\r\n            data.successFun && data.successFun();\r\n            return;\r\n        }\r\n        var videoId = GameData.getInstance().videoId;\r\n        if (data.isLongVideo) {\r\n            videoId = GameData.getInstance().longVideoId;\r\n        }\r\n        if (videoId.length <= 0) {\r\n            TipsManager.getInstance().showDefaultTips('开发中');\r\n            data.errorFun && data.errorFun();\r\n            return;\r\n        }\r\n        ViewChangeManager.getInstance().showBufferLoadingView();\r\n        var adId = videoId[Math.floor(Math.random() * videoId.length)];\r\n        platform.createRewardedVideoAd(adId, function (res) {\r\n            if (res.isEnded) {\r\n                data.successFun && data.successFun();\r\n                if (!DeviceUtil.isTTMiniGame()) {\r\n                    SoundManager.getInstance().playBgMusic();\r\n                }\r\n                console.log(\" video normal！\");\r\n            }\r\n            else {\r\n                data.failFun && data.failFun();\r\n                if (!DeviceUtil.isTTMiniGame()) {\r\n                    SoundManager.getInstance().playBgMusic();\r\n                }\r\n                console.log(\" video not finish！\");\r\n            }\r\n            ViewChangeManager.getInstance().hideBufferLoadingView();\r\n        }, function () {\r\n            ViewChangeManager.getInstance().hideBufferLoadingView();\r\n            TipsManager.getInstance().showDefaultTips('网络错误');\r\n            data.errorFun && data.errorFun();\r\n            if (!DeviceUtil.isTTMiniGame()) {\r\n                SoundManager.getInstance().playBgMusic();\r\n            }\r\n        });\r\n    };\r\n    MiniManeger.prototype.showBannerAd = function (offset) {\r\n        if (!DeviceUtil.isMiniGame()) {\r\n            return;\r\n        }\r\n        if ((DeviceUtil.isQQMiniGame() || DeviceUtil.isWXMiniGame()) && !this.bFlagSpecialView) {\r\n            return;\r\n        }\r\n        console.log(\"showBannerAd\");\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            var info = platform.getSystemInfoSync();\r\n            if (info.appName.toUpperCase() == 'DOUYIN') {\r\n                return;\r\n            }\r\n        }\r\n        this.canShowBanner = true;\r\n        var bannerId = GameData.getInstance().bannerId;\r\n        if (bannerId.length <= 0) {\r\n            console.log(\"bannerId.length <= 0\");\r\n            return;\r\n        }\r\n        var adId = bannerId[Math.floor(Math.random() * bannerId.length)];\r\n        console.log(\"adId = \", adId);\r\n        if (this.bannerAd == null) {\r\n            var bannerAd = platform.createBannerAd(adId);\r\n            this.bannerAd = bannerAd;\r\n            if (bannerAd == null)\r\n                return;\r\n            bannerAd.show();\r\n        }\r\n        else {\r\n        }\r\n        this.bannerAd.show();\r\n        if (!this.canShowBanner) {\r\n            this.bannerAd.hide();\r\n        }\r\n        if (offset) {\r\n            if (!DeviceUtil.isQQMiniGame()) {\r\n                this.bannerAd.style.left = offset.w - this.bannerAd.style.realWidth / 2 + 0.1;\r\n                this.bannerAd.style.top = offset.h - this.bannerAd.style.realHeight + 0.1;\r\n            }\r\n            offset.callback && offset.callback();\r\n        }\r\n        if (DeviceUtil.isQQMiniGame() || DeviceUtil.isWXMiniGame()) {\r\n            this.refreshBinner();\r\n        }\r\n    };\r\n    MiniManeger.prototype.refreshBinnerReadl = function () {\r\n        if (!this.bFlagSpecialView) {\r\n            return;\r\n        }\r\n        if (DeviceUtil.isQQMiniGame()) {\r\n            var bannerId = GameData.getInstance().bannerId;\r\n            if (bannerId.length <= 0) {\r\n                console.log(\"bannerId.length <= 0\");\r\n                return;\r\n            }\r\n            var adId = bannerId[Math.floor(Math.random() * bannerId.length)];\r\n            platform.binnerDestroy();\r\n            this.hideBanner();\r\n            this.bannerAd = null;\r\n            this.bannerAd = platform.createBannerAd(adId);\r\n            this.showBannerAd();\r\n        }\r\n    };\r\n    MiniManeger.prototype.refreshBinner = function () {\r\n        if (this.bTimerOpen) {\r\n            return;\r\n        }\r\n        this.bTimerOpen = true;\r\n        Laya.timer.clear(this, this.refreshBinnerReadl);\r\n        Laya.timer.loop(BaseConst.infos.gameInfo.binnertime, this, this.refreshBinnerReadl);\r\n    };\r\n    MiniManeger.prototype.hideBanner = function () {\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            var info = platform.getSystemInfoSync();\r\n            if (info.appName.toUpperCase() == 'DOUYIN') {\r\n                return;\r\n            }\r\n        }\r\n        if (this.bannerAd != null) {\r\n            this.bannerAd.hide();\r\n        }\r\n        this.canShowBanner = false;\r\n        console.log(\"hideBanner\");\r\n    };\r\n    MiniManeger.prototype.resetBinnerOper = function () {\r\n        if (!this.stPhoneInfo) {\r\n            this.stPhoneInfo = platform.getSystemInfoSync();\r\n        }\r\n        if (this.bannerAd) {\r\n            this.bannerAd.style.left = this.stPhoneInfo.screenWidth / 2 - this.bannerAd.style.realWidth / 2 + 0.1;\r\n            this.bannerAd.style.top = this.stPhoneInfo.screenHeight - this.bannerAd.style.realHeight + 0.1;\r\n        }\r\n    };\r\n    MiniManeger.prototype.adaptImgToClientRect = function (collec_img, stage) {\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            var systemInfo = platform.getSystemInfoSync();\r\n            var screenHeight = systemInfo['screenHeight'];\r\n            var screenWidth = systemInfo['screenWidth'];\r\n            var rect = platform.getMenuButtonBoundingClientRect();\r\n            collec_img.top = stage.height * (rect['top'] / screenHeight);\r\n            collec_img.right = stage.width * (1 - rect['right'] / screenWidth) + collec_img.width;\r\n        }\r\n    };\r\n    MiniManeger.prototype.sendDataToWxOpen = function (data) {\r\n        Laya.MiniAdpter.window.wx.postMessage(data);\r\n    };\r\n    MiniManeger.prototype.removeOpenData = function (data) {\r\n        var wxOpenData = data.parent.getChildByName('wxOpenData');\r\n        this.sendDataToWxOpen({ cmd: 'close', data: null });\r\n        if (wxOpenData) {\r\n            wxOpenData.removeSelf();\r\n            wxOpenData.destroy();\r\n            wxOpenData = null;\r\n        }\r\n    };\r\n    MiniManeger.prototype.addOpenWxData = function (data) {\r\n        var shareData = MiniManeger.instance.getShareInfo({ id: GameData.getInstance().userInfo.openId });\r\n        this.sendDataToWxOpen({ cmd: 'share', data: JSON.stringify(shareData) });\r\n        var wxOpenData = data.parent.getChildByName('wxOpenData');\r\n        if (wxOpenData) {\r\n            wxOpenData.removeSelf();\r\n            wxOpenData.destroy();\r\n            wxOpenData = null;\r\n        }\r\n        wxOpenData = new Laya.WXOpenDataViewer();\r\n        wxOpenData.name = 'wxOpenData';\r\n        wxOpenData.x = data.x || 0;\r\n        wxOpenData.y = data.y || 0;\r\n        wxOpenData.width = data.width;\r\n        wxOpenData.height = data.height;\r\n        if (data.isCenter) {\r\n            wxOpenData.centerX = 0;\r\n            wxOpenData.centerY = 0;\r\n        }\r\n        else {\r\n            if (data.left != null) {\r\n                wxOpenData.left = data.left;\r\n            }\r\n            if (data.right != null) {\r\n                wxOpenData.right = data.right;\r\n            }\r\n            if (data.top != null) {\r\n                wxOpenData.top = data.top;\r\n            }\r\n            if (data.bottom != null) {\r\n                wxOpenData.bottom = data.bottom;\r\n            }\r\n        }\r\n        if (data.parent) {\r\n            data.parent.addChild(wxOpenData);\r\n        }\r\n        return wxOpenData;\r\n    };\r\n    MiniManeger.prototype.initBlockAd = function () {\r\n        if (!DeviceUtil.isQQMiniGame()) {\r\n            return;\r\n        }\r\n        this.blockAd = platform.createBlockAD();\r\n    };\r\n    MiniManeger.prototype.showBlockAd = function () {\r\n        if (!DeviceUtil.isQQMiniGame()) {\r\n            return;\r\n        }\r\n        if (!this.blockAd) {\r\n            return;\r\n        }\r\n        console.log(\"显示积木广告--\");\r\n        this.blockAd.show().then(function () {\r\n            console.log(\"积木广告显示成功！\");\r\n        })[\"catch\"](function (err) {\r\n            console.log(\"积木广告显示失败！ \", err);\r\n        });\r\n    };\r\n    MiniManeger.prototype.hideBlockAd = function () {\r\n        if (!DeviceUtil.isQQMiniGame()) {\r\n            return;\r\n        }\r\n        if (!this.blockAd) {\r\n            return;\r\n        }\r\n        this.blockAd.hide();\r\n    };\r\n    MiniManeger.prototype.initBoxAd = function () {\r\n        var self = this;\r\n        if (!self.tempBoxAD) {\r\n            self.tempBoxAD = platform.createAppBox(GameData.getInstance().boxId[0]);\r\n            self.tempBoxAD.load().then(function (res) {\r\n                console.log(\"boxAd load\");\r\n            })[\"catch\"](function (err) {\r\n                console.log(\"boxAd load err\");\r\n                console.log(err);\r\n            });\r\n            self.tempBoxAD.onClose(function () {\r\n                self._imgRect && self._imgRect.removeSelf();\r\n                self.onCloseBoxAD && self.onCloseBoxAD();\r\n            });\r\n        }\r\n    };\r\n    MiniManeger.prototype.showBoxAd = function (onCloseCall) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var self, bxoAD;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                self = this;\r\n                self.onCloseBoxAD = onCloseCall;\r\n                if (DeviceUtil.isQQMiniGame()) {\r\n                    if (!self._imgRect) {\r\n                        self._imgRect = new Laya.Image(ResUtil.getIntance().getOriginUrlPath(ResUtil.getIntance().getResInfoByName(\"game_panel_db_png\").url));\r\n                        self._imgRect.sizeGrid = \"3,3,2,2\";\r\n                        self._imgRect.width = Laya.stage.width;\r\n                        self._imgRect.height = Laya.stage.height;\r\n                    }\r\n                    try {\r\n                        if (self.tempBoxAD) {\r\n                            bxoAD = self.tempBoxAD.load();\r\n                            if (bxoAD) {\r\n                                bxoAD.then(function () {\r\n                                    var boxAdShow = self.tempBoxAD.show();\r\n                                    if (boxAdShow) {\r\n                                        boxAdShow.then(function (res) {\r\n                                            console.log(\"boxAd show\");\r\n                                            console.log(res);\r\n                                            Laya.stage.addChild(self._imgRect);\r\n                                        })[\"catch\"](function (err) {\r\n                                            console.log(\"boxAd show err\");\r\n                                            console.log(err);\r\n                                            self.onCloseBoxAD && self.onCloseBoxAD();\r\n                                        });\r\n                                    }\r\n                                    else {\r\n                                        self.onCloseBoxAD && self.onCloseBoxAD();\r\n                                    }\r\n                                });\r\n                            }\r\n                            else {\r\n                                self.onCloseBoxAD && self.onCloseBoxAD();\r\n                            }\r\n                        }\r\n                        else {\r\n                            self.onCloseBoxAD && self.onCloseBoxAD();\r\n                        }\r\n                    }\r\n                    catch (err) {\r\n                        console.log(\"err<>>>>>\", err);\r\n                        self.onCloseBoxAD && self.onCloseBoxAD();\r\n                    }\r\n                }\r\n                else {\r\n                    self.onCloseBoxAD && self.onCloseBoxAD();\r\n                }\r\n                return [2];\r\n            });\r\n        });\r\n    };\r\n    MiniManeger.prototype.initVideoInfo = function () {\r\n        var _this = this;\r\n        if (!DeviceUtil.isTTMiniGame()) {\r\n            return;\r\n        }\r\n        this.recorder = platform.getGameRecorderManager();\r\n        this.recorder.onStart(function (res) {\r\n            console.log(\"onStart -> \", res);\r\n        });\r\n        this.recorder.onStop(function (res) {\r\n            _this.strVideoPatch = res.videoPath;\r\n            if (_this.nRecordTimeReal < 3000)\r\n                _this.strVideoPatch = null;\r\n            console.log(\"onStop ->\", _this.strVideoPatch);\r\n            MiniManeger.instance.saveCallF && MiniManeger.instance.saveCallF();\r\n        });\r\n        this.recorder.onPause(function (res) {\r\n            console.log(\"录制视频暂停 \");\r\n        });\r\n        this.recorder.onResume(function (res) {\r\n            console.log(\"录制视频继续 \");\r\n        });\r\n    };\r\n    MiniManeger.prototype.StartRecorderVideo = function () {\r\n        var _this = this;\r\n        if (!DeviceUtil.isTTMiniGame()) {\r\n            return;\r\n        }\r\n        this.nRecordTimeReal = 0;\r\n        this.strVideoPatch = \"\";\r\n        Laya.timer.once(100, this, function () {\r\n            platform.getGameRecorderManager().start({ duration: _this.nRecordTime });\r\n        });\r\n        Laya.timer.loop(1000, this, this.timeStopVideo);\r\n        console.log(\"开始录制视频\");\r\n    };\r\n    MiniManeger.prototype.timeStopVideo = function () {\r\n        this.nRecordTimeReal += 1000;\r\n        if (this.nRecordTimeReal >= this.nRecordTime * 1000) {\r\n            this.StopVideo();\r\n        }\r\n    };\r\n    MiniManeger.prototype.StopVideo = function () {\r\n        if (!DeviceUtil.isTTMiniGame()) {\r\n            return;\r\n        }\r\n        EventMgr.getInstance().sendEvent(GameEvent.CHANGE_VIDEO_IMAGE);\r\n        platform.getGameRecorderManager().stop();\r\n        Laya.timer.clear(this, this.timeStopVideo);\r\n        console.log(\"停止录制视频  this.nRecordTimeReal=\", this.nRecordTimeReal);\r\n    };\r\n    MiniManeger.prototype.resumeVideo = function () {\r\n        platform.getGameRecorderManager().resume();\r\n        console.log(\"继续录制视频 \");\r\n    };\r\n    MiniManeger.prototype.pauseVideo = function () {\r\n        platform.getGameRecorderManager().resume();\r\n        console.log(\"暂停录制视频 \");\r\n    };\r\n    MiniManeger.prototype.shareGameVideo = function (data) {\r\n        if (!this.strVideoPatch || this.strVideoPatch.length == 0) {\r\n            TipsManager.getInstance().showDefaultTips(\"暂未录制视频哦!\");\r\n            return;\r\n        }\r\n        if (this.nRecordTimeReal <= 3000) {\r\n            TipsManager.getInstance().showDefaultTips(\"录制视频失败\");\r\n            data.failFun && data.failFun();\r\n            return;\r\n        }\r\n        if (!DeviceUtil.isTTMiniGame()) {\r\n            return;\r\n        }\r\n        console.log(\"分享游戏视频--\");\r\n        var obj = {};\r\n        obj.title = \"阿罗斯营救\";\r\n        obj.query = \"openId=\" + GameData.getInstance().userInfo.openId + \"&nick=\" + GameData.getInstance().userInfo.nick;\r\n        obj.videoPath = this.strVideoPatch;\r\n        obj.success = function () {\r\n            console.log(\"视频分享成功！\");\r\n            TipsManager.getInstance().showDefaultTips(\"发布录制视频成功\");\r\n            data.successFun && data.successFun();\r\n        };\r\n        obj.fail = function (res) {\r\n            console.log(\"视频分享失败！\", res);\r\n            data.failFun && data.failFun();\r\n            TipsManager.getInstance().showDefaultTips(\"发布录制视频失败\");\r\n        };\r\n        platform.shareVideo(obj);\r\n    };\r\n    MiniManeger.prototype.onShareVideo = function (data) {\r\n        this.shareGameVideo(data);\r\n    };\r\n    MiniManeger.prototype.showInterstitialAd = function () {\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            var info = platform.getSystemInfoSync();\r\n            if (info.appName.toUpperCase() == 'DOUYIN') {\r\n                return;\r\n            }\r\n            var strID = BaseConst.infos.gameInfo.InterstitialAd;\r\n            if (!strID && strID == \"\") {\r\n                return;\r\n            }\r\n            platform.createInterstitialAd({ adUnitId: strID });\r\n            console.log(\"to show createInterstitialAd!strID = \", strID);\r\n        }\r\n    };\r\n    MiniManeger.prototype.showMoreGamesModal = function () {\r\n        var appLaunchOptions = [];\r\n        for (var i = 0, len = GameData.getInstance().weCatMiniIconsInfo.length; i < len; i++) {\r\n            appLaunchOptions.push({\r\n                appId: GameData.getInstance().weCatMiniIconsInfo[i].ad_appid,\r\n                query: \"\",\r\n                extraData: {}\r\n            });\r\n        }\r\n        platform.showMoreGamesModal({\r\n            appLaunchOptions: appLaunchOptions,\r\n            success: function (res) {\r\n                console.log(\"success\", res.errMsg);\r\n            },\r\n            fail: function (res) {\r\n                console.log(\"fail\", res.errMsg);\r\n            },\r\n            complete: function (res) {\r\n                console.log(\"complete\", res.errMsg);\r\n            }\r\n        });\r\n    };\r\n    MiniManeger.prototype.createGuessLike = function (parent) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\r\n                        var data, nCount, nIndex, i, guessLike;\r\n                        return tslib_1.__generator(this, function (_a) {\r\n                            switch (_a.label) {\r\n                                case 0:\r\n                                    data = PlatformDY.gameListInfos;\r\n                                    if (!(data == null)) return [3, 2];\r\n                                    return [4, PlatformDY.getGameList()];\r\n                                case 1:\r\n                                    data = _a.sent();\r\n                                    _a.label = 2;\r\n                                case 2:\r\n                                    if (data == null) {\r\n                                        resolve(null);\r\n                                        return [2];\r\n                                    }\r\n                                    if (data.length <= 0) {\r\n                                        return [2];\r\n                                    }\r\n                                    if (data.length < 10) {\r\n                                        nCount = 10 - data.length;\r\n                                        nIndex = 0;\r\n                                        for (i = 0; i < nCount; ++i) {\r\n                                            if (nIndex >= data.length) {\r\n                                                nIndex = 0;\r\n                                            }\r\n                                            data.push(data[nIndex]);\r\n                                            nIndex += 1;\r\n                                        }\r\n                                    }\r\n                                    console.log(\"data(GuessLike) ->\", data);\r\n                                    guessLike = parent.getChildByName('GuessLike');\r\n                                    if (guessLike == null) {\r\n                                        guessLike = new GuessLike(\"game/uiView/GuessLike.json\", \"game/uiView/GuessLikeItem.json\", data, 220);\r\n                                        parent.addChild(guessLike);\r\n                                    }\r\n                                    guessLike.name = 'GuessLike';\r\n                                    guessLike.mouseThrough = true;\r\n                                    guessLike.x = (Laya.stage.width - guessLike.width) / 2;\r\n                                    guessLike.y = Laya.stage.height - guessLike.height;\r\n                                    resolve(guessLike);\r\n                                    return [2];\r\n                            }\r\n                        });\r\n                    }); })];\r\n            });\r\n        });\r\n    };\r\n    MiniManeger.prototype.getAppInfo = function () {\r\n        var nIndex = 0;\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            nIndex = 0;\r\n        }\r\n        else if (DeviceUtil.isQQMiniGame()) {\r\n            nIndex = 1;\r\n        }\r\n        else if (DeviceUtil.isTTMiniGame()) {\r\n            nIndex = 2;\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n        return this.specialData[nIndex];\r\n    };\r\n    MiniManeger.prototype.toGameSpecial = function () {\r\n        var nIndex = 0;\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            nIndex = 0;\r\n        }\r\n        else if (DeviceUtil.isQQMiniGame()) {\r\n            nIndex = 1;\r\n        }\r\n        else if (DeviceUtil.isTTMiniGame()) {\r\n            nIndex = 2;\r\n        }\r\n        else {\r\n            return;\r\n        }\r\n        var stDataTemp = this.specialData[nIndex];\r\n        if (BaseConst.infos.gameInfo.isDY) {\r\n            PlatformDY.clickGame(stDataTemp.AppID);\r\n        }\r\n        var data = {\r\n            appId: stDataTemp.AppID,\r\n            path: stDataTemp.path,\r\n            extraData: stDataTemp.extraData,\r\n            success: function () {\r\n                console.log(\"toGameSpecial success!\");\r\n                if (BaseConst.infos.gameInfo.isDY) {\r\n                    console.log(\"self.nIndex = \", stDataTemp.AppID);\r\n                    PlatformDY.toGame(stDataTemp.AppID);\r\n                }\r\n            },\r\n            fail: function (e) {\r\n                console.log(\"toGameSpecial fail e =\", e);\r\n            }\r\n        };\r\n        platform.navigateToMiniProgram(data);\r\n    };\r\n    MiniManeger.prototype.checkCityInfo = function () {\r\n        if (!BaseConst.infos.gameInfo.region) {\r\n            return;\r\n        }\r\n        HttpMgr.getInstance().sendHttpTemp(this.strApiUrl, null, function (data) {\r\n            console.log(\"regioninfo = \", data);\r\n            var strRegion = data;\r\n            var nLen = BaseConst.infos.gameInfo.region.length;\r\n            var strDataTemp = \"\";\r\n            for (var i = 0; i < nLen; ++i) {\r\n                strDataTemp = BaseConst.infos.gameInfo.region[i];\r\n                if (strRegion.indexOf(strDataTemp) != -1) {\r\n                    BaseConst.infos.gameInfo.succShowBox = 0;\r\n                    BaseConst.infos.gameInfo.siginC = 0;\r\n                    BaseConst.infos.gameInfo.boxWDJ = 0;\r\n                    break;\r\n                }\r\n            }\r\n        }, function () {\r\n        });\r\n    };\r\n    MiniManeger.prototype.isAiQiYi = function () {\r\n        return PlatfprmAiQiYi.isOpen;\r\n    };\r\n    MiniManeger.prototype.compareVersion = function (v1, v2) {\r\n        var v1Arr = v1.split(\".\");\r\n        var v2Arr = v2.split(\".\");\r\n        var len = Math.max(v1Arr.length, v2Arr.length);\r\n        while (v1Arr.length < len) {\r\n            v1Arr.push(\"0\");\r\n        }\r\n        while (v2Arr.length < len) {\r\n            v2Arr.push(\"0\");\r\n        }\r\n        for (var i = 0; i < len; i++) {\r\n            var num1 = parseInt(v1Arr[i]);\r\n            var num2 = parseInt(v2Arr[i]);\r\n            if (num1 > num2) {\r\n                return 1;\r\n            }\r\n            else if (num1 < num2) {\r\n                return -1;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    MiniManeger.prototype.addColorSign = function (data) {\r\n        if (DeviceUtil.isQQMiniGame()) {\r\n            if (this.compareVersion(this.systemInfo.SDKVersion, \"1.10.0\") >= 0) {\r\n                platform.addColorSign(data);\r\n            }\r\n        }\r\n    };\r\n    MiniManeger.prototype.isColorSignExistSync = function () {\r\n        if (this.compareVersion(this.systemInfo.SDKVersion, \"1.16.0\") >= 0) {\r\n            return platform.isColorSignExistSync();\r\n        }\r\n        else {\r\n            return this.compareVersion(this.systemInfo.SDKVersion, \"1.10.0\") >= 0;\r\n        }\r\n    };\r\n    return MiniManeger;\r\n}());\r\nexport { MiniManeger };\r\n",
  "references": [
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/GameData.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/manager/InviteManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/SoundManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/GameDataManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/ConfigManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/CommonDefine.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/ViewChangeManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/GameEvent.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/PlatformDY.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/tool/NativeMgr.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/base/net/HttpMgr.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/PlatfprmAiQiYi.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/GuessLike.ts"
  ]
}
