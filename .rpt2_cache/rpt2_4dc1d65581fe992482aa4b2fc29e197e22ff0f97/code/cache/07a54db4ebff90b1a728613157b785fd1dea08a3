{
  "code": "import * as tslib_1 from \"tslib\";\r\nimport MoreGameRandomGameBoxItem713 from \"./MoreGameRandomGameBoxItem713\";\r\nimport PlatformDY from \"../../../../PlatformDY\";\r\nimport MoreGameOperRequestTwo from \"./MoreGameOperRequestTwo\";\r\nimport MoreGameRandomGameBox713Temp from \"./MoreGameRandomGameBox713Temp\";\r\nimport WeCatMoreGameView from \"./WeCatMoreGameView\";\r\nimport MoreGameViewTemp from \"./MoreGameViewTemp\";\r\nimport { PopBaseScene } from \"../../base/PopBaseScene\";\r\nimport { MiniManeger } from \"../../../minigame/MiniManeger\";\r\nimport ViewChangeManager from \"../../../games/ViewChangeManager\";\r\nimport { PlayerDataManager } from \"../../../common/GameDataManager\";\r\nimport { LevelManager } from \"../../../manager/LevelManager\";\r\nimport { GameData } from \"../../../common/GameData\";\r\nimport { GoodsType, EnterGameType } from \"../../../games/CommonDefine\";\r\nimport AddPsView from \"../AddPsView\";\r\nimport SuccessfulEntryOneView from \"../SuccessfulEntryOneView\";\r\nimport SuccessfulEntryThreeView from \"../SuccessfulEntryThreeView\";\r\nimport FailEntryTwoView from \"../FailEntryTwoView\";\r\nimport GameStateManager from \"../../../games/GameStateManager\";\r\nvar MoreGameRandomGameBox713 = (function (_super) {\r\n    tslib_1.__extends(MoreGameRandomGameBox713, _super);\r\n    function MoreGameRandomGameBox713() {\r\n        var _this = _super.call(this) || this;\r\n        _this.className_key = \"MoreGameOperRequest\";\r\n        _this.nStartY = 0;\r\n        _this.bContinue = false;\r\n        _this.scrollSizeMax = 50;\r\n        _this.nTimePanel = 5000;\r\n        _this.skin = \"game/uiView/wecat/MoreGameRandomGameBox713.json\";\r\n        _this.nRandomIndxe = 0;\r\n        _this.bAniOver = false;\r\n        _this.nOpenNum = 0;\r\n        return _this;\r\n    }\r\n    MoreGameRandomGameBox713.prototype.childrenCreated = function () {\r\n        _super.prototype.childrenCreated.call(this);\r\n        this.panel_gamelist.height = Laya.stage.height - (1920 - 1640);\r\n    };\r\n    MoreGameRandomGameBox713.prototype.onRemoved = function () {\r\n        _super.prototype.onRemoved.call(this);\r\n        this.bAniOver = true;\r\n    };\r\n    MoreGameRandomGameBox713.prototype.addEvent = function () {\r\n        this.registerEvent(this.imageBtReturn, Laya.Event.CLICK, this.onBackTemp, this);\r\n        this.registerEvent(this.imageBtConGame, Laya.Event.CLICK, this.onSpeical, this);\r\n        this.panel_gamelist.on(Laya.Event.MOUSE_DOWN, this, this.mousedown);\r\n        this.registerEvent(this.imageRandom, Laya.Event.CLICK, this.goToGameRandom, this);\r\n    };\r\n    MoreGameRandomGameBox713.prototype.mousedown = function (evt) {\r\n        this.nStartY = evt.currentTarget.mouseY;\r\n        var self = this;\r\n        function mouseMove(evt1) {\r\n            var nYTemp = self.nStartY - evt1.currentTarget.mouseY;\r\n            self.moreGamePanel.y -= nYTemp;\r\n            self.moreGamePanel2.y -= nYTemp;\r\n            self.nStartY = evt1.currentTarget.mouseY;\r\n            if (self.moreGamePanel.y >= 0 && self.moreGamePanel2.y >= 0) {\r\n                self.moreGamePanel.y = 0;\r\n                self.moreGamePanel2.y = self.moreGamePanel.height;\r\n            }\r\n        }\r\n        function mouseUp(evt1) {\r\n            this.panel_gamelist.off(Laya.Event.MOUSE_MOVE, this, mouseMove);\r\n            this.panel_gamelist.off(Laya.Event.MOUSE_UP, this, mouseUp);\r\n        }\r\n        this.panel_gamelist.on(Laya.Event.MOUSE_MOVE, this, mouseMove);\r\n        this.panel_gamelist.on(Laya.Event.MOUSE_UP, this, mouseUp);\r\n    };\r\n    MoreGameRandomGameBox713.prototype.initPanel = function () {\r\n    };\r\n    MoreGameRandomGameBox713.prototype.initView = function () {\r\n        this.nOpenNum += 1;\r\n        MiniManeger.instance.bFlagSpecialView = false;\r\n        MiniManeger.instance.hideBanner();\r\n        Laya.timer.clear(this, this.onMove);\r\n        ViewChangeManager.getInstance().CommonView.visible = false;\r\n        this.initPanel();\r\n        var nXStart = 0;\r\n        var nYStart = 0;\r\n        var nCount = 3;\r\n        var aryInfo = [];\r\n        aryInfo = this.getRandomIndex(18);\r\n        this.moreGamePanel.removeChildren();\r\n        this.moreGamePanel.y = 0;\r\n        for (var i = 0; i < aryInfo.length; ++i) {\r\n            var pWeCatMoreGameItemOne = this.moreGamePanel.getChildAt(i);\r\n            if (pWeCatMoreGameItemOne) {\r\n                pWeCatMoreGameItemOne.setData(aryInfo[i]);\r\n            }\r\n            else {\r\n                pWeCatMoreGameItemOne = new MoreGameRandomGameBoxItem713(aryInfo[i]);\r\n                var nAddX = Math.floor(i % nCount);\r\n                var nYAdd = Math.floor(i / nCount);\r\n                pWeCatMoreGameItemOne.x = nXStart + pWeCatMoreGameItemOne.width * nAddX + 30 * nAddX;\r\n                pWeCatMoreGameItemOne.y = nYStart + pWeCatMoreGameItemOne.height * nYAdd + 10 * nYAdd;\r\n                this.moreGamePanel.addChild(pWeCatMoreGameItemOne);\r\n                this.nTimePanel = (nYAdd + 1) * 1000;\r\n                this.moreGamePanel.height = pWeCatMoreGameItemOne.y + pWeCatMoreGameItemOne.height;\r\n            }\r\n        }\r\n        this.moreGamePanel2.y = this.moreGamePanel.height;\r\n        this.moreGamePanel2.removeChildren();\r\n        for (var i = 0; i < aryInfo.length; ++i) {\r\n            var pWeCatMoreGameItemOne = this.moreGamePanel2.getChildAt(i);\r\n            if (pWeCatMoreGameItemOne) {\r\n                pWeCatMoreGameItemOne.setData(aryInfo[i]);\r\n            }\r\n            else {\r\n                pWeCatMoreGameItemOne = new MoreGameRandomGameBoxItem713(aryInfo[i]);\r\n                var nAddX = Math.floor(i % nCount);\r\n                var nYAdd = Math.floor(i / nCount);\r\n                pWeCatMoreGameItemOne.x = nXStart + pWeCatMoreGameItemOne.width * nAddX + 30 * nAddX;\r\n                pWeCatMoreGameItemOne.y = nYStart + pWeCatMoreGameItemOne.height * nYAdd + 10 * nYAdd;\r\n                this.moreGamePanel2.addChild(pWeCatMoreGameItemOne);\r\n                this.nTimePanel = (nYAdd + 1) * 1000;\r\n                this.moreGamePanel2.height = pWeCatMoreGameItemOne.y + pWeCatMoreGameItemOne.height;\r\n            }\r\n        }\r\n        if (BaseConst.infos.gameInfo.isDY) {\r\n            PlatformDY.refreshGameList();\r\n        }\r\n        Laya.timer.frameLoop(1, this, this.onMove);\r\n        if ((this.nOpenNum >= 2 || !PlayerDataManager.getInstance().bIsNewPlayer) && BaseConst.infos.gameInfo.openPsAward == 1) {\r\n            this.timerChangerImage();\r\n        }\r\n        else {\r\n            this.changeImage();\r\n        }\r\n    };\r\n    MoreGameRandomGameBox713.prototype.timerChangerImage = function () {\r\n        this.imageBtConGame.skin = \"resource/assets/img/wecat/box_button_2.png\";\r\n        this.bContinue = false;\r\n        Laya.timer.clear(this, this.changeImage);\r\n        Laya.timer.once(5000, this, this.changeImage);\r\n    };\r\n    MoreGameRandomGameBox713.prototype.changeImage = function () {\r\n        this.imageBtConGame.skin = \"resource/assets/img/wecat/box_button_3.png\";\r\n        this.bContinue = true;\r\n    };\r\n    MoreGameRandomGameBox713.prototype.onSpecialGotoGame = function () {\r\n        if (PlayerDataManager.bGlobEnterGame) {\r\n            ViewManager.getInstance().showView(WeCatMoreGameView);\r\n            this.removeSelf();\r\n            Laya.timer.clearAll(this);\r\n            MoreGameRandomGameBox713.bOperFlag = false;\r\n            MoreGameRandomGameBox713.bSuccess = false;\r\n            MoreGameRandomGameBox713.bGotoNextGame = false;\r\n            MoreGameRandomGameBox713.toHome = false;\r\n            MoreGameRandomGameBox713.bEnterHotBox = false;\r\n            MoreGameRandomGameBox713.bReStartGame = false;\r\n            return;\r\n        }\r\n        this.onClickOper();\r\n    };\r\n    MoreGameRandomGameBox713.prototype.onSpeical = function () {\r\n        if (this.bContinue) {\r\n            this.onSpecialGotoGame();\r\n        }\r\n        else {\r\n            this.goToGameRandom();\r\n        }\r\n    };\r\n    MoreGameRandomGameBox713.prototype.onMove = function () {\r\n        var nHight = this.moreGamePanel.height;\r\n        this.moreGamePanel2.y -= 2;\r\n        this.moreGamePanel.y -= 2;\r\n        if (this.moreGamePanel.y <= -nHight) {\r\n            this.moreGamePanel.y = this.moreGamePanel2.y + nHight;\r\n        }\r\n        if (this.moreGamePanel2.y <= -nHight) {\r\n            this.moreGamePanel2.y = this.moreGamePanel.y + nHight;\r\n        }\r\n    };\r\n    MoreGameRandomGameBox713.prototype.onBackTemp = function () {\r\n        if (PlayerDataManager.getInstance().checkIsSpecial() && BaseConst.infos.gameInfo.MoreGameView == 1) {\r\n            ViewManager.getInstance().showView(MoreGameViewTemp);\r\n        }\r\n        else {\r\n            MoreGameRandomGameBox713Temp.bSpecial = true;\r\n            ViewManager.getInstance().showView(MoreGameRandomGameBox713Temp);\r\n        }\r\n    };\r\n    MoreGameRandomGameBox713.prototype.onBack = function () {\r\n        MoreGameOperRequestTwo.bOperFlag = MoreGameRandomGameBox713.bOperFlag;\r\n        MoreGameOperRequestTwo.bSuccess = MoreGameRandomGameBox713.bSuccess;\r\n        MoreGameOperRequestTwo.bGotoNextGame = MoreGameRandomGameBox713.bGotoNextGame;\r\n        MoreGameOperRequestTwo.toHome = MoreGameRandomGameBox713.toHome;\r\n        MoreGameOperRequestTwo.bReStartGame = MoreGameRandomGameBox713.bReStartGame;\r\n        MiniManeger.instance.bFlagSpecialView = false;\r\n        ViewManager.getInstance().showView(MoreGameOperRequestTwo);\r\n        this.removeSelf();\r\n        Laya.timer.clearAll(this);\r\n        MoreGameRandomGameBox713.bOperFlag = false;\r\n        MoreGameRandomGameBox713.bSuccess = false;\r\n        MoreGameRandomGameBox713.bGotoNextGame = false;\r\n        MoreGameRandomGameBox713.toHome = false;\r\n        MoreGameRandomGameBox713.bEnterHotBox = false;\r\n        MoreGameRandomGameBox713.bReStartGame = false;\r\n    };\r\n    MoreGameRandomGameBox713.prototype.goToGame = function () {\r\n    };\r\n    MoreGameRandomGameBox713.prototype.getRandomIndex = function (nMax) {\r\n        if (GameData.getInstance().weCatMiniIconsInfo.length - 1 < 0) {\r\n            return [];\r\n        }\r\n        var nRandom = Utils.random(0, GameData.getInstance().weCatMiniIconsInfo.length - 1);\r\n        var nCount = GameData.getInstance().weCatMiniIconsInfo.length % 3;\r\n        if (nCount > 0) {\r\n            nCount = 3 - nCount;\r\n        }\r\n        nCount = GameData.getInstance().weCatMiniIconsInfo.length + nCount;\r\n        if (nCount <= nMax) {\r\n            nCount = nMax;\r\n        }\r\n        var aryInfo = [];\r\n        for (var i = 0; i < nCount; ++i) {\r\n            aryInfo.push(nRandom);\r\n            nRandom += 1;\r\n            if (nRandom >= GameData.getInstance().weCatMiniIconsInfo.length) {\r\n                nRandom = 0;\r\n            }\r\n        }\r\n        return aryInfo;\r\n    };\r\n    MoreGameRandomGameBox713.prototype.panelScrollAni = function () {\r\n    };\r\n    MoreGameRandomGameBox713.prototype.onClickOper = function () {\r\n        var _this = this;\r\n        if (!MoreGameRandomGameBox713.bEnterHotBox) {\r\n            MiniManeger.instance.bFlagSpecialView = true;\r\n            if (MoreGameRandomGameBox713.bGotoNextGame) {\r\n                var nSpCost = 1;\r\n                var b = PlayerDataManager.getInstance().CheckGoods(GoodsType.enum_GoodsType_Sp, nSpCost);\r\n                if (!b) {\r\n                    TipsManager.getInstance().showDefaultTips(\"体力不足\");\r\n                    ViewChangeManager.getInstance().showBufferLoadingView();\r\n                    ResUtil.getIntance().loadGroups([\"adsp\"], function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\r\n                        return tslib_1.__generator(this, function (_a) {\r\n                            ViewManager.getInstance().showView(AddPsView);\r\n                            ViewChangeManager.getInstance().hideBufferLoadingView();\r\n                            return [2];\r\n                        });\r\n                    }); });\r\n                    return;\r\n                }\r\n                PlayerDataManager.getInstance().subGoods(GoodsType.enum_GoodsType_Sp, nSpCost);\r\n                if (PlayerDataManager.getInstance().getCurLevel() < BaseConst.infos.gameInfo.splevel\r\n                    || BaseConst.infos.gameInfo.openPsAward == 0) {\r\n                    ViewChangeManager.getInstance().goToNextLevel();\r\n                }\r\n                else {\r\n                    ViewManager.getInstance().showView(SuccessfulEntryOneView);\r\n                }\r\n            }\r\n            else {\r\n                if (MoreGameRandomGameBox713.bOperFlag) {\r\n                    if (MoreGameRandomGameBox713.bSuccess) {\r\n                        if (BaseConst.infos.gameInfo.openPsAward == 1\r\n                            && PlayerDataManager.getInstance().getCurLevel() >= BaseConst.infos.gameInfo.splevel\r\n                            && BaseConst.infos.gameInfo.for_pay == 1) {\r\n                            ViewManager.getInstance().showView(SuccessfulEntryOneView);\r\n                        }\r\n                        else {\r\n                            ViewManager.getInstance().showView(SuccessfulEntryThreeView);\r\n                        }\r\n                    }\r\n                    else {\r\n                        ViewManager.getInstance().showView(FailEntryTwoView);\r\n                    }\r\n                }\r\n            }\r\n            if (MoreGameRandomGameBox713.toHome) {\r\n                ViewChangeManager.getInstance().CurLevelBase.closeGameView();\r\n                PlayerDataManager.getInstance().setCurLevel(PlayerDataManager.getInstance().getCurLevelMax());\r\n                GameStateManager.getInstance().levelState = EnterGameType.enum_EnterGameType_GameHome;\r\n                LevelManager.getInstance().createLevelScene(PlayerDataManager.getInstance().getCurLevelToChallenge());\r\n            }\r\n            ViewChangeManager.getInstance().CommonView.visible = true;\r\n        }\r\n        else {\r\n            this.onBack();\r\n        }\r\n        this.removeSelf();\r\n        Laya.timer.clearAll(this);\r\n        MiniManeger.instance.showBannerAd();\r\n        MoreGameRandomGameBox713.bOperFlag = false;\r\n        MoreGameRandomGameBox713.bSuccess = false;\r\n        MoreGameRandomGameBox713.bGotoNextGame = false;\r\n        MoreGameRandomGameBox713.toHome = false;\r\n        MoreGameRandomGameBox713.bEnterHotBox = false;\r\n        MoreGameRandomGameBox713.bReStartGame = false;\r\n    };\r\n    MoreGameRandomGameBox713.prototype.goToGameRandom = function () {\r\n        this.aryCatMiniIconsInfoTemp = GameData.getInstance().weCatMiniIconsInfo;\r\n        if (this.aryCatMiniIconsInfoTemp.length <= 0) {\r\n            return;\r\n        }\r\n        this.nRandomIndxe = Utils.random(0, this.aryCatMiniIconsInfoTemp.length - 1);\r\n        if (BaseConst.infos.gameInfo.isDY) {\r\n            PlatformDY.clickGame(this.aryCatMiniIconsInfoTemp[this.nRandomIndxe].ad_id);\r\n        }\r\n        var self = this;\r\n        var stData = this.aryCatMiniIconsInfoTemp[this.nRandomIndxe].ad_id;\r\n        var data = {\r\n            appId: this.aryCatMiniIconsInfoTemp[self.nRandomIndxe].ad_appid,\r\n            path: this.aryCatMiniIconsInfoTemp[self.nRandomIndxe].url,\r\n            success: function () {\r\n                console.log(\"navigateToMiniProgram success\");\r\n                if (BaseConst.infos.gameInfo.isDY) {\r\n                    console.log(\"self.nIndex = \", stData);\r\n                    PlatformDY.toGame(stData.ad_id);\r\n                }\r\n            },\r\n            fail: function (e) {\r\n                console.log(\"navigateToMiniProgram fail e =\", e);\r\n                MoreGameRandomGameBox713Temp.bSpecial = true;\r\n                ViewManager.getInstance().showView(MoreGameRandomGameBox713Temp);\r\n            }\r\n        };\r\n        platform.navigateToMiniProgram(data);\r\n    };\r\n    MoreGameRandomGameBox713.bOperFlag = false;\r\n    MoreGameRandomGameBox713.bSuccess = false;\r\n    MoreGameRandomGameBox713.toHome = false;\r\n    MoreGameRandomGameBox713.bGotoNextGame = false;\r\n    MoreGameRandomGameBox713.bEnterHotBox = false;\r\n    MoreGameRandomGameBox713.bReStartGame = false;\r\n    MoreGameRandomGameBox713.nEnterCount = 0;\r\n    return MoreGameRandomGameBox713;\r\n}(PopBaseScene));\r\nexport default MoreGameRandomGameBox713;\r\n",
  "references": [
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/MoreGameOperReqIndex.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/GameStateManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/manager/GameManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/MoreGameRandomGameBoxItem713.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/PlatformDY.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/MoreGameOperRequestTwo.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/MoreGameRandomGameBox713Temp.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/WeCatMoreGameView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/MoreGameViewTemp.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/base/PopBaseScene.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/minigame/MiniManeger.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/ViewChangeManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/GameDataManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/manager/LevelManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/GameData.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/CommonDefine.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/AddPsView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/SuccessfulEntryOneView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/SuccessfulEntryThreeView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/FailEntryTwoView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/GameStateManager.ts"
  ]
}
