{
  "code": "import * as tslib_1 from \"tslib\";\r\nimport ViewChangeManager from \"../games/ViewChangeManager\";\r\nimport { PlayerDataManager } from \"../common/GameDataManager\";\r\nimport LevelView from \"./game/LevelView\";\r\nimport SignView from \"./game/SignView\";\r\nimport ConfigManager from \"../games/ConfigManager\";\r\nimport AddPsView from \"./game/AddPsView\";\r\nimport { GoodsType } from \"../games/CommonDefine\";\r\nimport SoundManager from \"../common/SoundManager\";\r\nimport InviteView from \"./game/invite/InviteView\";\r\nimport { MiniManeger } from \"../minigame/MiniManeger\";\r\nimport NativeMgr from \"../tool/NativeMgr\";\r\nimport { LotteryScene } from \"./game/lottery/LotteryScene\";\r\nimport WeCatMoreGameView from \"./game/wecat/WeCatMoreGameView\";\r\nimport MoreGameOperRequestTwo from \"./game/wecat/MoreGameOperRequestTwo\";\r\nvar GameHomeView = (function (_super) {\r\n    tslib_1.__extends(GameHomeView, _super);\r\n    function GameHomeView() {\r\n        var _this = _super.call(this) || this;\r\n        _this.className_key = \"GameHomeView\";\r\n        _this.skin = \"game/GameHomeView.json\";\r\n        _this.bIsRunning = false;\r\n        _this.bWeCatShow = false;\r\n        return _this;\r\n    }\r\n    GameHomeView.prototype.childrenCreated = function () {\r\n        _super.prototype.childrenCreated.call(this);\r\n        this.btn_more.visible = false;\r\n        if (DeviceUtil.isQQMiniGame() || DeviceUtil.isTTMiniGame()) {\r\n            this.btn_more.visible = true;\r\n        }\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            this.getChildByName(\"imageHead\").skin = \"resource/assets/preloading/loading_logo_4.png\";\r\n        }\r\n        else if (DeviceUtil.isQQMiniGame()) {\r\n            this.getChildByName(\"imageHead\").skin = \"resource/assets/preloading/loading_logo.png\";\r\n        }\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            this.imageWeCatMoreGame.visible = true;\r\n            this.more_games.visible = true;\r\n            this.getChildByName(\"imageHead\").skin = \"resource/assets/preloading/loading_logo_8.png\";\r\n            this.getChildByName(\"imageHead\").visible = false;\r\n        }\r\n        if (MiniManeger.instance.isAiQiYi()) {\r\n            this.getChildByName(\"imageHead\").skin = \"resource/assets/preloading/loading_logo_x.png\";\r\n        }\r\n        this.addGuessLike();\r\n    };\r\n    GameHomeView.prototype.onAddStage = function () {\r\n        AddPsView.bCloseBinner = false;\r\n        MiniManeger.instance.showBannerAd();\r\n        this.bIsRunning = true;\r\n        this.startGameAni();\r\n        this.initView();\r\n    };\r\n    GameHomeView.prototype.onRemoved = function () {\r\n        this.bIsRunning = false;\r\n        _super.prototype.onRemoved.call(this);\r\n        this.removeEvent();\r\n        Laya.Tween.clearAll(this.imageBtStartGame);\r\n        Laya.Tween.clearAll(this.image_wm);\r\n    };\r\n    GameHomeView.prototype.onLottery = function () {\r\n        var _this = this;\r\n        SoundManager.getInstance().playEffect(\"button\", 1);\r\n        ViewChangeManager.getInstance().showBufferLoadingView();\r\n        ResUtil.getIntance().loadGroups([\"lottery\"], function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\r\n            return tslib_1.__generator(this, function (_a) {\r\n                ViewManager.getInstance().showView(LotteryScene);\r\n                ViewChangeManager.getInstance().hideBufferLoadingView();\r\n                return [2];\r\n            });\r\n        }); });\r\n    };\r\n    GameHomeView.prototype.addEvent = function () {\r\n        this.btn_lottery.on(Laya.Event.CLICK, this, this.onLottery);\r\n        this.btn_colorSign.on(Laya.Event.CLICK, this, this.onColorSign);\r\n        this.imageBtStartGame.on(Laya.Event.CLICK, this, this.gameHomeStartGame);\r\n        this.btn_more.on(Laya.Event.CLICK, this, this.onMoreGame);\r\n        this.imageBtChoseLevel.on(Laya.Event.CLICK, this, this.openLevelView);\r\n        this.imageBtSign.on(Laya.Event.CLICK, this, this.openSignView);\r\n        this.imageBtShare.on(Laya.Event.CLICK, this, this.onGameHomeShare);\r\n        this.imageBtInvital.on(Laya.Event.CLICK, this, this.onInvite);\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            this.imageWeCatMoreGame.on(Laya.Event.CLICK, this, this.openChouTiView);\r\n            this.more_games.on(Laya.Event.CLICK, this, this.wxShowMoreGame);\r\n            this.back_btn.on(Laya.Event.CLICK, this, this.wxShowMoreGame);\r\n            this.image_wm.on(Laya.Event.CLICK, MiniManeger.instance, MiniManeger.instance.toGameSpecial);\r\n        }\r\n    };\r\n    GameHomeView.prototype.openChouTiView = function () {\r\n        ViewManager.getInstance().showView(WeCatMoreGameView);\r\n    };\r\n    GameHomeView.prototype.onMoreGame = function () {\r\n        if (DeviceUtil.isQQMiniGame()) {\r\n            MiniManeger.instance.showBoxAd();\r\n        }\r\n        else if (DeviceUtil.isTTMiniGame()) {\r\n            MiniManeger.instance.showMoreGamesModal();\r\n        }\r\n    };\r\n    GameHomeView.prototype.removeEvent = function () {\r\n        this.btn_lottery.off(Laya.Event.CLICK, this, this.onLottery);\r\n        this.btn_colorSign.off(Laya.Event.CLICK, this, this.onColorSign);\r\n        this.imageBtStartGame.off(Laya.Event.CLICK, this, this.gameHomeStartGame);\r\n        this.btn_more.off(Laya.Event.CLICK, this, this.onMoreGame);\r\n        this.imageBtChoseLevel.off(Laya.Event.CLICK, this, this.openLevelView);\r\n        this.imageBtSign.off(Laya.Event.CLICK, this, this.openSignView);\r\n        this.imageBtShare.off(Laya.Event.CLICK, this, this.onGameHomeShare);\r\n        this.imageBtInvital.off(Laya.Event.CLICK, this, this.onInvite);\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            this.imageWeCatMoreGame.off(Laya.Event.CLICK, this, this.openChouTiView);\r\n            this.more_games.off(Laya.Event.CLICK, this, this.wxShowMoreGame);\r\n            this.back_btn.off(Laya.Event.CLICK, this, this.wxShowMoreGame);\r\n            this.image_wm.off(Laya.Event.CLICK, MiniManeger.instance, MiniManeger.instance.toGameSpecial);\r\n        }\r\n    };\r\n    GameHomeView.prototype.wxShowMoreGame = function () {\r\n        ViewManager.getInstance().showView(MoreGameOperRequestTwo);\r\n    };\r\n    GameHomeView.prototype.gameHomeStartGame = function () {\r\n        if (DeviceUtil.isNative()) {\r\n            NativeMgr.getInstance().showInterstitialAd();\r\n        }\r\n        SoundManager.getInstance().playEffect(\"button\", 1);\r\n        var nSpCost = 1;\r\n        var stGameConfig = ConfigManager.getInstance().getGameConfigDataByID(8);\r\n        if (stGameConfig) {\r\n            nSpCost = parseInt(stGameConfig.strValue);\r\n        }\r\n        var b = PlayerDataManager.getInstance().CheckGoods(GoodsType.enum_GoodsType_Sp, nSpCost);\r\n        if (!b) {\r\n            TipsManager.getInstance().showDefaultTips(\"体力不足\");\r\n            ViewChangeManager.getInstance().showBufferLoadingView();\r\n            ResUtil.getIntance().loadGroups([\"adsp\"], function () {\r\n                ViewManager.getInstance().showView(AddPsView);\r\n                ViewChangeManager.getInstance().hideBufferLoadingView();\r\n            });\r\n            return;\r\n        }\r\n        PlayerDataManager.getInstance().subGoods(GoodsType.enum_GoodsType_Sp, nSpCost);\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            MiniManeger.instance.hideBanner();\r\n        }\r\n        ViewChangeManager.getInstance().CurLevelBase.startGame();\r\n        this.removeSelf();\r\n    };\r\n    GameHomeView.prototype.initView = function () {\r\n        ViewChangeManager.getInstance().restartEnterGameHome();\r\n        this.PlInitView();\r\n        this.showSignView();\r\n        BitmapLabelUtils.setLabel(this.spLevelNum, PlayerDataManager.getInstance().getLevelToChangeMaxLevel().toString(), \"resource/assets/img/ui/gamehome/maininterface_number1/maininterface_number1_\", 0, \".png\", \"center\");\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            this.image_wm.visible = true;\r\n            this.startWmAni();\r\n        }\r\n        if (DeviceUtil.isQQMiniGame() && BaseConst.infos.gameInfo.openPsAward == 1) {\r\n            MiniManeger.instance.showBlockAd();\r\n            this.btn_lottery.visible = true;\r\n            var flag = MiniManeger.instance.isColorSignExistSync();\r\n            if (!flag) {\r\n                this.btn_colorSign.visible = true;\r\n            }\r\n            else {\r\n                this.btn_colorSign.visible = false;\r\n            }\r\n        }\r\n        else if (DeviceUtil.isTTMiniGame()) {\r\n            this.btn_lottery.visible = true;\r\n        }\r\n    };\r\n    GameHomeView.prototype.onColorSign = function () {\r\n        var _this = this;\r\n        MiniManeger.instance.addColorSign({\r\n            success: function (res) {\r\n                console.log(res);\r\n                _this.btn_colorSign.visible = false;\r\n            }\r\n        });\r\n    };\r\n    GameHomeView.prototype.openLevelView = function () {\r\n        var _this = this;\r\n        SoundManager.getInstance().playEffect(\"button\", 1);\r\n        ViewChangeManager.getInstance().showBufferLoadingView();\r\n        ResUtil.getIntance().loadGroups([\"levelview\"], function () {\r\n            LevelView.pHomeView = _this;\r\n            ViewManager.getInstance().showView(LevelView);\r\n            ViewChangeManager.getInstance().hideBufferLoadingView();\r\n        });\r\n    };\r\n    GameHomeView.prototype.openSignView = function () {\r\n        SoundManager.getInstance().playEffect(\"button\", 1);\r\n        ViewChangeManager.getInstance().showBufferLoadingView();\r\n        ResUtil.getIntance().loadGroups([\"sign\"], function () {\r\n            Laya.Resource.destroyUnusedResources();\r\n            ViewManager.getInstance().showView(SignView);\r\n            ViewChangeManager.getInstance().hideBufferLoadingView();\r\n        });\r\n    };\r\n    GameHomeView.prototype.onGameHomeShare = function () {\r\n        SoundManager.getInstance().playEffect(\"button\", 1);\r\n        MiniManeger.instance.bFlagDouYin = false;\r\n        MiniManeger.instance.shareAppMessage();\r\n    };\r\n    GameHomeView.prototype.onInvite = function () {\r\n        SoundManager.getInstance().playEffect(\"button\", 1);\r\n        ViewChangeManager.getInstance().showBufferLoadingView();\r\n        ResUtil.getIntance().loadGroups([\"invite\"], function () {\r\n            ViewManager.getInstance().showView(InviteView);\r\n            ViewChangeManager.getInstance().hideBufferLoadingView();\r\n        });\r\n    };\r\n    GameHomeView.prototype.startGameAni = function () {\r\n        var _this = this;\r\n        if (!this.bIsRunning) {\r\n            return;\r\n        }\r\n        Laya.Tween.clearAll(this.imageBtStartGame);\r\n        Laya.Tween.to(this.imageBtStartGame, { scaleX: 1.1, scaleY: 1.1 }, 300, Laya.Ease.sineOut, Laya.Handler.create(this, function (args) {\r\n            Laya.Tween.to(_this.imageBtStartGame, { scaleX: 1, scaleY: 1 }, 300, Laya.Ease.sineOut, Laya.Handler.create(_this, function (args) {\r\n                Laya.timer.once(0, _this, _this.startGameAni);\r\n            }));\r\n        }));\r\n    };\r\n    GameHomeView.prototype.PlInitView = function () {\r\n        if (DeviceUtil.isTTMiniGame() || MiniManeger.instance.isAiQiYi()) {\r\n            this.imageBtInvital.visible = false;\r\n            this.boxFun.width = 650;\r\n        }\r\n    };\r\n    GameHomeView.prototype.showSignView = function () {\r\n        this.addEvent();\r\n    };\r\n    GameHomeView.prototype.onGetFreeSkin = function () {\r\n    };\r\n    GameHomeView.prototype.weCatViewOper = function () {\r\n        this.wxShowMoreGame();\r\n    };\r\n    GameHomeView.prototype.startWmAni = function () {\r\n        var _this = this;\r\n        if (!this.bIsRunning) {\r\n            return;\r\n        }\r\n        Laya.Tween.clearAll(this.image_wm);\r\n        Laya.Tween.to(this.image_wm, { scaleX: 1.1, scaleY: 1.1 }, 300, Laya.Ease.sineOut, Laya.Handler.create(this, function (args) {\r\n            Laya.Tween.to(_this.image_wm, { scaleX: 1, scaleY: 1 }, 300, Laya.Ease.sineOut, Laya.Handler.create(_this, function (args) {\r\n                Laya.timer.once(0, _this, _this.startWmAni);\r\n            }));\r\n        }));\r\n    };\r\n    GameHomeView.prototype.addGuessLike = function () {\r\n        var self = this;\r\n        if (!self._guessLike && DeviceUtil.isWXMiniGame()) {\r\n            MiniManeger.instance.createGuessLike(self).then(function (guessLike) {\r\n                if (!guessLike) {\r\n                    return;\r\n                }\r\n                self._guessLike = guessLike;\r\n                self._guessLike.x = (Laya.stage.width - self._guessLike.width) / 2;\r\n                self._guessLike.y = 250;\r\n            });\r\n        }\r\n    };\r\n    return GameHomeView;\r\n}(BaseSceneUISkin));\r\nexport default GameHomeView;\r\n",
  "references": [
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/ViewChangeManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/GameDataManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/LevelView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/SignView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/ConfigManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/GameEvent.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/AddPsView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/games/CommonDefine.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/SoundManager.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/invite/InviteView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/minigame/MiniManeger.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/FailEntryTwoView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/SuccessfulEntryThreeView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/common/GameData.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/FailEntryOneView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/tool/NativeMgr.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/lottery/LotteryScene.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/GuessLike.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/WeCatMoreGameView.ts",
    "F:/gitpro/ecy_game_framework/game_framework_ecy/game_framework_ecy/src/script/views/game/wecat/MoreGameOperRequestTwo.ts"
  ]
}
